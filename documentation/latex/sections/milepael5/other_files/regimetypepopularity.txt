year | source.government | count


val aggr = df.groupBy("`source.source.year`").agg(count(when(col("`source.source.government`") === "Presidential Democracy", true)).as("presidential_democracy"),count(when(col("`source.source.government`") === "Parliamentary Democracy", true)).as("parliamentary_democracy"), count(when(col("`source.source.government`") === "Personal Dictatorship", true)).as("personal_dictatorship"), count(when(col("`source.source.government`") === "Party-Personal", true)).as("party-personal"), count(when(col("`source.source.government`") === "Provisional - Military", true)).as("provisional_military"), count(when(col("`source.source.government`") === "Military", true)).as("military"), count(when(col("`source.source.government`") === "Military-Personal", true)).as("military_personal"), count(when(col("`source.source.government`") === "Provisional - Civilian", true)).as("provisional_civilian"), count(when(col("`source.source.government`") === "Foreign/Occupied", true)).as("foreign/occupied"), count(when(col("`source.source.government`") === "Dominant Party", true)).as("dominant_party"), count(when(col("`source.source.government`") === "Indirect Military", true)).as("indirect_military"), count(when(col("`source.source.government`") === "Party-Military", true)).as("party-military"), count(when(col("`source.source.government`") === "Party-Personal-Military Hybrid", true)).as("party-personal-military_hybrid"), count(when(col("`source.source.government`") === "Oligarchy", true)).as("oligarchy"), count(when(col("`source.source.government`") === "Monarchy", true)).as("monarchy"),count(when(col("`source.source.government`") === "Warlordism", true)).as("warlordism"))


